---
created_at: 2023-09-14
modified_at: 2023-09-15
description: 
aliases: 
tags:
  - 操作系统
---

## 概念
虚拟机, 作为一层抽象屏蔽底层资源差异,  并暴路出一组接口供上层软件调用。

## 特征
并发并行 共享 虚拟 异步

## 目标与功能
管理（进程、线程调度，虚拟内存系统，硬件设备，文件管理）
接口（系统调用，命令行接口，图形接口）
扩充机器
封装

## 发展
手工操作阶段
批处理阶段
	单道批处理
	多道批处理
分时系统
实时系统
分布式
## CPU运行状态
内核态用户态
## 中断
作用 让内核强行夺取CPU控制权, 时CPU从用户态进入内核态
中断异常陷阱硬中断软中断内中断外中断 
中断 O中断 时钟中断
中断屏蔽中断判优
### 中断程序执行过程
```mermaid
flowchart TB
A[执行指令] --> B[指令结束] --> C{有中断请求?}
C --N--> A
subgraph zhongduan [中断响应]
direction TB
D[关中断] --> E[保存断点] --> F[中断程序寻址] --> G["保存上下文（屏蔽字）"] --> X[开中断] --> H[运行中断服务] --> Y[关中断]--> I[恢复上下文] --> Z[开中断] --> J[中断返回]
end
C --Y--> D
J --> A
```
### 系统调用执行过程
```mermaid
flowchart LR

subgraph D [库函数]

A[...] --> B["系统调用号 -> eax\n其他参数 -> ebx,ecx,edx,esi,edi"] --> C[INT $0x80触发陷阱] --> E --> F[...] --> G[返回]

end

  

subgraph E [中断响应过程]

EA[关中断] --> EB[保存断点] --> EC[中断程序寻址] --> ED[保存上下文] --> EE[开中断] --> H --> EF[关中断] --> EG[恢复上下文] --> EH[开中断] --> EI[中断返回]

end

  

subgraph H [system_call]

HA[系统服务号检查]

HA --> HB[根据服务号执行对应系统调用]
HB --> I --> HZ

HZ[返回]

end

  

subgraph I [服务例程]

...

end
```
## 内核体系
宏内核 微内核 混合内核