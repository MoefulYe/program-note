---
created_at: 2023-10-04
modified_at: 2023-10-04
description: 
aliases: 
tags:
  - 操作系统
---
## 目的
实现从物理结构上的块设备的按块存取到逻辑上的按文件存取
用文件系统来抽象块设备
## 和数据库的根本区别
数据库的数据是高度结构化的 而文件的内容大多数无结构或者是半结构化的
## 常见文件系统
- ext4
- ntfs
- vfat
- xfs
- brtfs
- zfs
- ...
## 文件
### 定义
一组有意义的信息的集合
### 元信息
创建访问修改时间
类型
权限控制
所属用户用户组
...
### 接口
create
delete
read
write
open
close
...
### 打开文件表 系统级文件表
### 文件的逻辑结构
- 无结构文件
- 结构化文件
	由一组相似的记录组成，又称**记录式文件**。每条记录又若干个数据项组成
	根据每条记录的长度是否相等，可以分为**定长记录**和**可变长记录**两种
	- 顺序文件
	- 索引文件
	- 索引顺序文件
## 目录
### FCB
inode
### 目录结构
- 单级结构
- 两极结构
- 树形
- 有向无环图
### 实现
- 线性表
- 哈希
## 文件共享
- 硬链接
- 软链接
## 访问控制
- 口令
- 加密
- [[../权限模型|权限管理]]
## 文件系统栈
![[../assets/img/20231004003207.png]]
文件系统和设备间应该还有个驱动层
## VFS
抽象统一接口
### 对象类型
- 超级块对象
- 索引节点对象
- 目录对象
- 文件对象

### 文件系统挂载
- 在VFS中注册新挂载的文件系统，在挂载表中添加文件系统的相关信息
- 向VFS提供函数地址列表
- 将新的文件系统加到挂载点
## 文件系统建立
1. 空白磁盘
2. 物理格式化
3. 逻辑格式化
## 划分
- 分区表
- 主引导记录
- 引导块
- inode空闲位向量
- 数据块空闲位向量
- inode表
- 数据块
- 索引块
## 文件空间分配

- 连续分配
- 链接分配
	- 隐链接
	- 显式链接
- 索引分配
	- 链接索引块
	- 多级索引
	- 混合索引
### 空间管理
- 空闲表
- 空闲链表
- 位向量
- 成组链接法